{% extends 'home/base.html' %}

{% block title %}{{ venue.name }} ¬∑ Eventflow{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">

  <!-- ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ -->
  <a href="{% url 'venue_list' %}" class="text-sm text-[#3f72af] hover:underline">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</a>

  <div class="mt-3 bg-white rounded-2xl shadow overflow-hidden">
    
    <!-- ‚úÖ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏ö‡∏ö Carousel -->
    {% if images %}
      <div x-data="{ current: 0 }" class="relative aspect-[16/9] bg-gray-100">
        {% for img in images %}
          <img 
            src="{{ img.image.url }}" 
            alt="‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà {{ forloop.counter }}"
            class="absolute inset-0 w-full h-full object-cover transition duration-300"
            x-show="current === {{ forloop.counter0 }}"
            x-transition:enter="opacity-0"
            x-transition:enter-end="opacity-100"
            x-transition:leave="opacity-100"
            x-transition:leave-end="opacity-0"
          />
        {% endfor %}

        {% if images|length > 1 %}
          <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ -->
          <button 
            @click="current = (current - 1 + {{ images|length }}) % {{ images|length }}"
            class="absolute left-2 top-1/2 -translate-y-1/2 bg-white/70 hover:bg-white text-gray-700 rounded-full p-1 shadow"
          >‚Üê</button>

          <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏ß‡∏≤ -->
          <button 
            @click="current = (current + 1) % {{ images|length }}"
            class="absolute right-2 top-1/2 -translate-y-1/2 bg-white/70 hover:bg-white text-gray-700 rounded-full p-1 shadow"
          >‚Üí</button>
        {% endif %}
      </div>
    {% else %}
      <div class="aspect-[16/9] bg-gray-100 flex items-center justify-center text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</div>
    {% endif %}

    <!-- ‚úÖ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà -->
    <div class="p-6">
      <div class="flex items-start justify-between gap-6 flex-col md:flex-row">
        <div class="flex-1">
          <h1 class="text-2xl font-bold text-[#112d4e]">{{ venue.name }}</h1>
          <p class="mt-2 text-gray-700 whitespace-pre-line">{{ venue.description }}</p>
          <div class="mt-4 space-y-1 text-sm text-gray-600">
            <p><span class="font-semibold text-[#112d4e]">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</span> {{ venue.address }}</p>
            <p><span class="font-semibold text-[#112d4e]">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏ß‡∏±‡∏ô:</span> {{ venue.price_per_day }}</p>
          </div>
        </div>

        {% if request.user == venue.owner %}
        <div class="flex items-center gap-2">
          <a href="{% url 'venue_update' venue.pk %}" class="px-4 py-2 rounded-xl bg-[#3f72af] hover:bg-[#2f5d97] text-white">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</a>
          <a href="{% url 'venue_delete' venue.pk %}" class="px-4 py-2 rounded-xl bg-red-500 hover:bg-red-600 text-white">‡∏•‡∏ö</a>
        </div>
        {% endif %}
      </div>

      <!-- ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å -->
      <h3 class="mt-6 text-lg font-semibold text-[#112d4e]">‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å</h3>
      {% with a=venue.venueamenity %}
      <ul class="mt-2 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 text-gray-700 list-disc list-inside">
        {% if a.wifi %}<li>Wi-Fi ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï</li>{% endif %}
        {% if a.parking %}<li>‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏î‡∏£‡∏ñ</li>{% endif %}
        {% if a.equipment %}<li>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏µ‡∏¨‡∏≤</li>{% endif %}
        {% if a.sound_system %}<li>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á / ‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô</li>{% endif %}
        {% if a.projector %}<li>‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå / ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠</li>{% endif %}
        {% if a.air_conditioning %}<li>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏®</li>{% endif %}
        {% if a.seating %}<li>‡πÄ‡∏Å‡πâ‡∏≤‡∏≠‡∏µ‡πâ / ‡πÇ‡∏ï‡πä‡∏∞</li>{% endif %}
        {% if a.drinking_water %}<li>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏î‡∏ô‡πâ‡∏≥</li>{% endif %}
        {% if a.first_aid %}<li>‡∏ä‡∏∏‡∏î‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</li>{% endif %}
        {% if a.cctv %}<li>‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ß‡∏á‡∏à‡∏£‡∏õ‡∏¥‡∏î / ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</li>{% endif %}
      </ul>
      {% endwith %}

      <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà -->
    {% if request.user != venue.owner %}
      <div class="mt-10 text-center">
        <a href="{% url 'booking_create' %}?venue_id={{ venue.pk }}"
           class="inline-block bg-emerald-500 hover:bg-emerald-600 text-white font-semibold px-6 py-3 rounded-xl transition">
          üìÖ ‡∏à‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ
        </a>
      </div>
    {% endif %}
    </div>
  </div>
</div>

<!-- ‚úÖ Alpine.js ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Carousel -->
<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
{% endblock %}
